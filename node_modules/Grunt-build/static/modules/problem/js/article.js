/**
 * Author: denghuafeng
 * Date: 2016/5/24
 * Plugin Name:
 * Description: .
 */
define([
    "common",
    "modules/modules_common"
],function(common,modulesCommon){

    var ajaxFn = common.util.callApi,
        modulesUtil = modulesCommon.modulesUtil;

    var main = {

        init: function() {
            this.getDom();
            this.event();
            this.problemTypeInit();
        },
        domainUrl: "http://kf.37.com/index.php",
        /*绑定Dom*/
        getDom: function(){
            var _this = this;
            _this.$container = $(".container");
            _this.$article = $(".article");
            _this.$serviceTitle = _this.$article.find(".service-title");
            _this.$voteCount= _this.$article.find(".vote-count");
        },
        /*判断当前类型*/
        problemTypeInit:function(){
            var _this = this;
            $("#side-"+_this.$serviceTitle.data("type")).addClass("focus");
        },
        /*绑定事件*/
        event: function(){
            var _this = this;
            _this.$article
                /*靠谱点解*/
                .on("click",".vote-btn",function(){
                    if ( this.className.indexOf("pending") > -1 ) {
                        return;
                    }
                    $(this).siblings().removeClass("focus").end().addClass("focus");
                    $(".vote-btn").addClass("pending");
                    _this.$voteCount.html( parseInt(_this.$voteCount.html())+1);

                })
                .on("mouseenter",".vote-btn",function(){
                    if ( this.className.indexOf("pending") > -1 ) {
                        return;
                    }
                    $(this).siblings().removeClass("focus").end().addClass("focus");
                })
        }

    };
    return {
        init:function(){
            main.init();
        }
    };
});
